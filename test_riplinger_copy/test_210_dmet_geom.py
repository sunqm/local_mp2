import scipy
import numpy,os
from sys import path
path.append('/home/yuliya/DMET/alkanechains_scf_ccsd/dmet_parallel_ccsdt_frozen')
import orbital_selection_fc as orb

from pyscf import gto,scf,cc,mp, symm, ao2mo, mp

atoms=[
['C',(-0.78969, 0.78969, -0.09340)],
['C',(-0.78969, -0.78969, 0.09340)],
['C',(0.78969, -0.78969, -0.09340)],
['C',(0.78969, 0.78969, 0.09340)],
['C',(-1.60758, 1.60758, 0.91943)],
['C',(-1.24698, 1.24698, -1.49107)],
['C',( -1.24698, -1.24698, 1.49107)],
['C',( -1.60758, -1.60758, -0.91943)],
['C',(1.24698, -1.24698, -1.49107)],
['C',(1.60758, -1.60758, 0.91943)],
['C',(1.24698, 1.24698, 1.49107)],
['C',(1.60758, 1.60758, -0.91943)],
['H',(-1.36727, 1.36727, 1.95538)],
['H',(-1.42693, 2.67788, 0.76935)],
['H',(-2.67788, 1.42693, 0.76935)],
['H',(-0.73174, 0.73174, -2.30167)],
['H',(-2.32046, 1.06761, -1.60859)],
['H',(-1.06761, 2.32046, -1.60859)],
['H',(-0.73174, -0.73174, 2.30167)],
['H',(-2.32046, -1.06761, 1.60859)],
['H',(-1.06761, -2.32046, 1.60859)],
['H',(-1.36727, -1.36727, -1.95538)],
['H',(-1.42693, -2.67788, -0.76935)],
['H',(-2.67788, -1.42693, -0.76935)],
['H',(0.73174, -0.73174, -2.30167)],
['H',(2.32046, -1.06761, -1.60859)],
['H',(1.06761, -2.32046, -1.60859)],
['H',(1.36727, -1.36727, 1.95538)],
['H',(1.42693, -2.67788, 0.76935)],
['H',(2.67788, -1.42693, 0.76935)],
['H',(0.73174, 0.73174, 2.30167)],
['H',(2.32046, 1.06761, 1.60859)],
['H',(1.06761, 2.32046, 1.60859)],
['H',(1.36727, 1.36727, -1.95538)],
['H',(1.42693, 2.67788, -0.76935)],
['H',(2.67788, 1.42693, -0.76935)]]


mol = gto.M(atom = atoms, basis='cc-pvdz') # read the geometry, in A
m = scf.RHF(mol)
m.kernel()

#mycc = cc.CCSD(m)
#mycc.kernel()

#mymp2 = mp.MP2(m)
#mymp2.kernel()
del mol

bs     = 'dz'
basis  = {'C': 'cc-pv'+bs, 'H': 'cc-pv'+bs}
shells = {'C': ['sto-6g','cc-pv'+bs], 'H': ['sto-6g','cc-pv'+bs]}
charge = 0
spin   = 0

fragments = [[0],[1],[2],[3],[4,12,13,14],[5,15,16,17],[6,18,19,20],\
            [7,21,22,23],[8,24,25,26],[9,27,28,29],[10,30,31,32],[11,33,34,35]]
fragment_spins = [0,0,0,0,-1,1,-1,1,-1,1,-1,1]

thresh   = 1.0e-7
#method = 'cc' uncomment this line and comment the line below to switch to CC
method   = 'cc'
nfreeze  = 0
parallel = False

orb.DMET_wrap(atoms,basis,charge,spin,fragments,fragment_spins,shells,nfreeze,method,thresh,parallel)

