import scipy
import numpy,os
from sys import path
path.append('/home/yuliya/DMET/alkanechains_scf_ccsd/dmet_parallel_ccsdt_frozen')
import orbital_selection_fc as orb

from pyscf import gto,scf,cc,mp, symm, ao2mo, mp

""" 99_coord """

atoms=[
['O',(1.17176, 0.20003, -1.16422)],
['C',(2.18376, 0.24403, -0.50322)],
['O',(3.30476, -0.43597, -0.81122)],
['H',(3.08876, -0.95397, -1.60122)],
['C',(2.37676, 1.05603, 0.76178)],
['H',(3.26176, 1.67603, 0.62878)],
['H',(2.56376, 0.37003, 1.58478)],
['N',(1.23576, 1.87903, 1.04378)],
['H',(0.42776, 1.45103, 1.47878)],
['C',(0.97976, 2.91103, 0.18478)],
['O',(1.81576, 3.37203, -0.57822)],
['C',(-0.46624, 3.38403, 0.21078)],
['H',(-0.53724, 4.30703, -0.35522)],
['H',(-0.81224, 3.53903, 1.23078)],
['N',(-1.30224, 2.36803, -0.40022)],
['H',(-1.29724, 2.23703, -1.40322)],
['C',(-1.73124, 1.30403, 0.30678)],
['O',(-1.60524, 1.20703, 1.53078)],
['C',(-2.42724, 0.23503, -0.53322)],
['N',(-1.87824, 0.26103, -1.88522)],
['H',(-0.93024, -0.10497, -1.87622)],
['H',(-2.43024, -0.32197, -2.50122)],
['H',(-3.47324, 0.54903, -0.60322)],
['C',(-2.40824, -1.12297, 0.18978)],
['H',(-2.82424, -0.98097, 1.18678)],
['H',(-3.07224, -1.79397, -0.35822)],
['C',(-1.04424, -1.74597, 0.28478)],
['C',(-0.55124, -2.53997, -0.75522)],
['H',(-1.17324, -2.72497, -1.62222)],
['C',(0.71376, -3.12097, -0.68022)],
['H',(1.07076, -3.74097, -1.49222)],
['C',(1.50676, -2.92097, 0.44778)],
['H',(2.48476, -3.37697, 0.51578)],
['C',(1.02176, -2.14097, 1.49778)],
['H',(1.61976, -2.00597, 2.38978)],
['C',(-0.24124, -1.55797, 1.41578)],
['H',(-0.62224, -0.95997, 2.23378)]]

mol = gto.M(atom = atoms, basis='cc-pvdz') # read the geometry, in A
#m = scf.RHF(mol)
#m.kernel()

#mycc = cc.CCSD(m)
#mycc.kernel()
del mol

bs     = 'dz'
basis  = {'C': 'cc-pv'+bs, 'H': 'cc-pv'+bs, 'O': 'cc-pv'+bs, 'N': 'cc-pv'+bs}
shells = {'C': ['sto-6g','cc-pv'+bs], 'H': ['sto-6g','cc-pv'+bs], 'O': ['sto-6g','cc-pv'+bs], 'N': ['sto-6g','cc-pv'+bs]}
charge = 0
spin   = 0

fragments,fragment_spins = [[0,1,2,3],[4,5,6],\
                          [7,8,9,10],[11,12,13],[14,15,16,17],[19,20,21],[18,22],\
                          [23,24,25],\
                          [26],[27,28],[29,30],[31,32],[33,34],[35,36]],[0,0,0,0,0,0,0,0,0,1,-1,1,-1]

thresh   = 1.0e-5
#method = 'cc' uncomment this line and comment the line below to switch to CC
method   = 'cc'
nfreeze  = 0
parallel = False

orb.DMET_wrap(atoms,basis,charge,spin,fragments,fragment_spins,shells,nfreeze,method,thresh,parallel)

